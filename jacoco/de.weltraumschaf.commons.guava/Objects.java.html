<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Objects.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Commons Guava</a> &gt; <a href="index.source.html" class="el_package">de.weltraumschaf.commons.guava</a> &gt; <span class="el_source">Objects.java</span></div><h1>Objects.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2007 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package de.weltraumschaf.commons.guava;

import de.weltraumschaf.commons.validate.Validate;
import java.util.Arrays;

/**
 * Helper functions that can operate on any {@code Object}.
 *
 * &lt;p&gt;
 * See the Guava User Guide on &lt;a
 * href=&quot;http://code.google.com/p/guava-libraries/wiki/CommonObjectUtilitiesExplained&quot;&gt;writing {@code Object} methods
 * with {@code Objects}&lt;/a&gt;.
 *
 * @author Laurence Gonsalves
 * @since 2.0 (imported from Google Collections Library)
 * @version $Id: $Id
 */
public final class Objects {

    /**
     * Hidden for pure static factory.
     */
    private Objects() {
<span class="fc" id="L39">        super();</span>
<span class="fc" id="L40">        throw new UnsupportedOperationException(&quot;Constructor must not be called by reflection!&quot;);</span>
    }

    /**
     * Determines whether two possibly-null objects are equal. Returns:
     *
     * &lt;ul&gt;
     * &lt;li&gt;{@code true} if {@code a} and {@code b} are both null.
     * &lt;li&gt;{@code true} if {@code a} and {@code b} are both non-null and they are equal according to
     * {@link java.lang.Object#equals(Object)}.
     * &lt;li&gt;{@code false} in all other situations.
     * &lt;/ul&gt;
     *
     * &lt;p&gt;
     * This assumes that any non-null objects passed to this function conform to the {@code equals()} contract.
     *
     * @param a first object to compare
     * @param b second object to compare
     * @return {@code true} if a and be are equal, else {@code false}
     */
    public static boolean equal(final Object a, final Object b) {
<span class="pc bpc" id="L61" title="1 of 6 branches missed.">        return a == b || a != null &amp;&amp; a.equals(b);</span>
    }

    /**
     * Generates a hash code for multiple values. The hash code is generated by calling
     * {@link java.util.Arrays#hashCode(Object[])}. Note that array arguments to this method, with the exception of a single
     * Object array, do not get any special handling; their hash codes are based on identity and not contents.
     *
     * &lt;p&gt;
     * This is useful for implementing {@link java.lang.Object#hashCode()}. For example, in an object that has three properties,
     * {@code x}, {@code y}, and {@code z}, one could write:
     * &lt;/p&gt;
     * &lt;pre&gt;   {@code
     *   public int hashCode() {
     *     return Objects.hashCode(getX(), getY(), getZ());
     *   }}&lt;/pre&gt;
     *
     * &lt;p&gt;
     * &lt;strong&gt;Warning&lt;/strong&gt;: When a single object is supplied, the returned hash code does not equal the hash code
     * of that object.
     * &lt;/p&gt;
     *
     * @param objects objects to hash
     * @return the has code
     */
    public static int hashCode(final Object... objects) {
<span class="fc" id="L87">        return Arrays.hashCode(objects);</span>
    }

    /**
     * Returns the first of two given parameters that is not {@code null}, if either is, or otherwise throws a
     * {@link java.lang.NullPointerException}.
     *
     * &lt;p&gt;
     * &lt;b&gt;Note:&lt;/b&gt; if {@code first} is represented as an {@code Optional&lt;T&gt;}, this can be accomplished with
     * {@code first.or(second)}. That approach also allows for lazy evaluation of the fallback instance, using
     * {@code first.or(Supplier)}.
     *
     * @return {@code first} if {@code first} is not {@code null}, or {@code second} if {@code first} is {@code null}
     * and {@code second} is not {@code null}
     * @throws java.lang.NullPointerException if both {@code first} and {@code second} were {@code null}
     * @since 2.0
     * @param first a T object.
     * @param second a T object.
     * @param &lt;T&gt; a T object.
     */
    public static &lt;T&gt; T firstNonNull(final T first, final T second) {
<span class="nc bnc" id="L108" title="All 2 branches missed.">        return first != null ? first : Validate.notNull(second);</span>
    }

    /**
     * Creates an instance of {@link de.weltraumschaf.commons.guava.Objects.ToStringHelper}.
     *
     * &lt;p&gt;
     * This is helpful for implementing {@link java.lang.Object#toString()}. Specification by example:
     * &lt;/p&gt;
     * &lt;pre&gt;   {@code
     *   // Returns &quot;ClassName{}&quot;
     *   Objects.toStringHelper(this)
     *       .toString();
     *
     *   // Returns &quot;ClassName{x=1}&quot;
     *   Objects.toStringHelper(this)
     *       .add(&quot;x&quot;, 1)
     *       .toString();
     *
     *   // Returns &quot;MyObject{x=1}&quot;
     *   Objects.toStringHelper(&quot;MyObject&quot;)
     *       .add(&quot;x&quot;, 1)
     *       .toString();
     *
     *   // Returns &quot;ClassName{x=1, y=foo}&quot;
     *   Objects.toStringHelper(this)
     *       .add(&quot;x&quot;, 1)
     *       .add(&quot;y&quot;, &quot;foo&quot;)
     *       .toString();
     *
     *   // Returns &quot;ClassName{x=1}&quot;
     *   Objects.toStringHelper(this)
     *       .omitNullValues()
     *       .add(&quot;x&quot;, 1)
     *       .add(&quot;y&quot;, null)
     *       .toString();
     *   }}&lt;/pre&gt;
     *
     * &lt;p&gt;
     * Note that in GWT, class names are often obfuscated.
     * &lt;/p&gt;
     *
     * @since 2.0
     * @param self the object to generate the string for (typically {@code this}), used only for its class name
     * @return never {@code null}, always new instance
     */
    public static ToStringHelper toStringHelper(final Object self) {
<span class="fc" id="L155">        return new ToStringHelper(simpleName(self.getClass()));</span>
    }

    /**
     * Creates an instance of {@link de.weltraumschaf.commons.guava.Objects.ToStringHelper} in the same manner as {@link de.weltraumschaf.commons.guava.Objects#toStringHelper(Object)}, but
     * using the name of {@code clazz} instead of using an instance's {@link java.lang.Object#getClass()}.
     *
     * &lt;p&gt;
     * Note that in GWT, class names are often obfuscated.
     * &lt;/p&gt;
     *
     * @since 7.0 (source-compatible since 2.0)
     * @param clazz the {@link java.lang.Class} of the instance
     * @return never {@code null}, always new instance
     */
    public static ToStringHelper toStringHelper(final Class&lt;?&gt; clazz) {
<span class="fc" id="L171">        return new ToStringHelper(simpleName(clazz));</span>
    }

    /**
     * Creates an instance of {@link de.weltraumschaf.commons.guava.Objects.ToStringHelper} in the same manner as {@link de.weltraumschaf.commons.guava.Objects#toStringHelper(Object)}, but
     * using {@code className} instead of using an instance's {@link java.lang.Object#getClass()}.
     *
     * @since 7.0 (source-compatible since 2.0)
     * @param className the name of the instance type
     * @return never {@code null}, always new instance
     */
    public static ToStringHelper toStringHelper(final String className) {
<span class="fc" id="L183">        return new ToStringHelper(className);</span>
    }

    /**
     * {@link Class#getSimpleName()} is not GWT compatible yet, so we provide our own implementation.
     *
     * @param clazz the {@link Class} of the instance
     * @return never {@code null}
     */
    private static String simpleName(final Class&lt;?&gt; clazz) {
<span class="fc" id="L193">        String name = clazz.getName();</span>

        // the nth anonymous class has a class name ending in &quot;Outer$n&quot;
        // and local inner classes have names ending in &quot;Outer.$1Inner&quot;
<span class="fc" id="L197">        name = name.replaceAll(&quot;\\$[0-9]+&quot;, &quot;\\$&quot;);</span>

        // we want the name of the inner class all by its lonesome
<span class="fc" id="L200">        int start = name.lastIndexOf('$');</span>

        // if this isn't an inner class, just find the start of the
        // top level class name.
<span class="pc bpc" id="L204" title="1 of 2 branches missed.">        if (start == -1) {</span>
<span class="fc" id="L205">            start = name.lastIndexOf('.');</span>
        }

<span class="fc" id="L208">        return name.substring(start + 1);</span>
    }

    /**
     * Support class for {@link Objects#toStringHelper}.
     *
     * @author Jason Lee
     * @since 2.0
     */
    public static final class ToStringHelper {

        /**
         * Default size for to string buffer.
         */
        private static final int DEFAULT_BUFFER_SIZE = 32;

        /**
         * Name of rendered class.
         */
        private final String className;
        /**
         * Holds the first member.
         */
<span class="fc" id="L231">        private final ValueHolder holderHead = new ValueHolder();</span>
        /**
         * Holds the last member.
         */
<span class="fc" id="L235">        private ValueHolder holderTail = holderHead;</span>
        /**
         * Whether {@code null} values should be omitted or not.
         */
        private boolean omitNullValues;

        /**
         * Use {@link Objects#toStringHelper(Object)} to create an instance.
         *
         * @param className must not be {@code null}
         */
<span class="fc" id="L246">        private ToStringHelper(final String className) {</span>
<span class="fc" id="L247">            this.className = Validate.notNull(className, &quot;className&quot;);</span>
<span class="fc" id="L248">        }</span>

        /**
         * Configures the {@link ToStringHelper} so {@link #toString()} will ignore properties with null value.
         *
         * The order of calling this method, relative to the {@code add()}/{@code addValue()} methods, is not
         * significant.
         *
         * @since 12.0
         * @return self for method chaining
         */
        public ToStringHelper omitNullValues() {
<span class="fc" id="L260">            omitNullValues = true;</span>
<span class="fc" id="L261">            return this;</span>
        }

        /**
         * Adds a name/value pair to the formatted output in {@code name=value} format.
         *
         * If {@code value} is {@code null}, the string {@code &quot;null&quot;} is used, unless {@link #omitNullValues()} is
         * called, in which case this name/value pair will not be added.
         *
         * @param name name of property
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper add(final String name, final Object value) {
<span class="fc" id="L275">            return addHolder(name, value);</span>
        }

        /**
         * Adds a name/value pair to the formatted output in {@code name=value} format.
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param name name of property
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper add(final String name, final boolean value) {
<span class="fc" id="L287">            return addHolder(name, String.valueOf(value));</span>
        }

        /**
         * Adds a name/value pair to the formatted output in {@code name=value} format.
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param name name of property
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper add(final String name, final char value) {
<span class="fc" id="L299">            return addHolder(name, String.valueOf(value));</span>
        }

        /**
         * Adds a name/value pair to the formatted output in {@code name=value} format.
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param name name of property
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper add(final String name, final double value) {
<span class="fc" id="L311">            return addHolder(name, String.valueOf(value));</span>
        }

        /**
         * Adds a name/value pair to the formatted output in {@code name=value} format.
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param name name of property
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper add(final String name, final float value) {
<span class="fc" id="L323">            return addHolder(name, String.valueOf(value));</span>
        }

        /**
         * Adds a name/value pair to the formatted output in {@code name=value} format.
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param name name of property
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper add(final String name, final int value) {
<span class="fc" id="L335">            return addHolder(name, String.valueOf(value));</span>
        }

        /**
         * Adds a name/value pair to the formatted output in {@code name=value} format.
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param name name of property
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper add(final String name, final long value) {
<span class="fc" id="L347">            return addHolder(name, String.valueOf(value));</span>
        }

        /**
         * Adds an unnamed value to the formatted output.
         *
         * &lt;p&gt;
         * It is strongly encouraged to use {@link #add(String, Object)} instead and give value a readable name.
         * &lt;/p&gt;
         *
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper addValue(final Object value) {
<span class="fc" id="L361">            return addHolder(value);</span>
        }

        /**
         * Adds an unnamed value to the formatted output.
         *
         * &lt;p&gt;
         * It is strongly encouraged to use {@link #add(String, boolean)} instead and give value a readable name.
         * &lt;/p&gt;
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper addValue(final boolean value) {
<span class="fc" id="L376">            return addHolder(String.valueOf(value));</span>
        }

        /**
         * Adds an unnamed value to the formatted output.
         *
         * &lt;p&gt;
         * It is strongly encouraged to use {@link #add(String, char)} instead and give value a readable name.
         * &lt;/p&gt;
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper addValue(final char value) {
<span class="fc" id="L391">            return addHolder(String.valueOf(value));</span>
        }

        /**
         * Adds an unnamed value to the formatted output.
         *
         * &lt;p&gt;
         * It is strongly encouraged to use {@link #add(String, double)} instead and give value a readable name.
         * &lt;/p&gt;
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper addValue(final double value) {
<span class="fc" id="L406">            return addHolder(String.valueOf(value));</span>
        }

        /**
         * Adds an unnamed value to the formatted output.
         *
         * &lt;p&gt;
         * It is strongly encouraged to use {@link #add(String, float)} instead and give value a readable name.
         * &lt;/p&gt;
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper addValue(final float value) {
<span class="fc" id="L421">            return addHolder(String.valueOf(value));</span>
        }

        /**
         * Adds an unnamed value to the formatted output.
         *
         * &lt;p&gt;
         * It is strongly encouraged to use {@link #add(String, int)} instead and give value a readable name.
         * &lt;/p&gt;
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper addValue(final int value) {
<span class="fc" id="L436">            return addHolder(String.valueOf(value));</span>
        }

        /**
         * Adds an unnamed value to the formatted output.
         *
         * &lt;p&gt;
         * It is strongly encouraged to use {@link #add(String, long)} instead and give value a readable name.
         * &lt;/p&gt;
         *
         * @since 11.0 (source-compatible since 2.0)
         * @param value value of property
         * @return self for method chaining
         */
        public ToStringHelper addValue(final long value) {
<span class="fc" id="L451">            return addHolder(String.valueOf(value));</span>
        }

        /**
         * Returns a string in the format specified by {@link Objects#toStringHelper(Object)}.
         *
         * &lt;p&gt;
         * After calling this method, you can keep adding more properties to later call toString() again and get a more
         * complete representation of the same object; but properties cannot be removed, so this only allows limited
         * reuse of the helper instance. The helper allows duplication of properties (multiple name/value pairs with the
         * same name can be added).
         * &lt;/p&gt;
         *
         * @return never {@code null}
         */
        @Override
        public String toString() {
            // create a copy to keep it consistent in case value changes
<span class="fc" id="L469">            final boolean omitNullValuesSnapshot = omitNullValues;</span>
<span class="fc" id="L470">            String nextSeparator = &quot;&quot;;</span>
<span class="fc" id="L471">            final StringBuilder builder = new StringBuilder(DEFAULT_BUFFER_SIZE).append(className)</span>
                    .append('{');

<span class="fc bfc" id="L474" title="All 2 branches covered.">            for (ValueHolder valueHolder = holderHead.next; valueHolder != null;</span>
<span class="fc" id="L475">                    valueHolder = valueHolder.next) {</span>
<span class="fc bfc" id="L476" title="All 4 branches covered.">                if (!omitNullValuesSnapshot || valueHolder.value != null) {</span>
<span class="fc" id="L477">                    builder.append(nextSeparator);</span>
<span class="fc" id="L478">                    nextSeparator = &quot;, &quot;;</span>

<span class="fc bfc" id="L480" title="All 2 branches covered.">                    if (valueHolder.name != null) {</span>
<span class="fc" id="L481">                        builder.append(valueHolder.name).append('=');</span>
                    }

<span class="fc" id="L484">                    builder.append(valueHolder.value);</span>
                }
            }

<span class="fc" id="L488">            return builder.append('}').toString();</span>
        }

        /**
         * Links a new {@link ValueHolder} to the tail of the values linked list and returns it.
         *
         * @return never {@code null}, always new instance
         */
        private ValueHolder addHolder() {
<span class="fc" id="L497">            final ValueHolder valueHolder = new ValueHolder();</span>
<span class="fc" id="L498">            holderTail.next = valueHolder;</span>
<span class="fc" id="L499">            holderTail = valueHolder;</span>
<span class="fc" id="L500">            return valueHolder;</span>
        }

        /**
         * Adds an unnamed value to the formatted output.
         *
         * @param value value of property
         * @return self for method chaining
         */
        private ToStringHelper addHolder(final Object value) {
<span class="fc" id="L510">            final ValueHolder valueHolder = addHolder();</span>
<span class="fc" id="L511">            valueHolder.value = value;</span>
<span class="fc" id="L512">            return this;</span>
        }

        /**
         * Adds an named value to the formatted output.
         *
         * @param name name of property
         * @param value value of property
         * @return self for method chaining
         */
        private ToStringHelper addHolder(final String name, final Object value) {
<span class="fc" id="L523">            final ValueHolder valueHolder = addHolder();</span>
<span class="fc" id="L524">            valueHolder.value = value;</span>
<span class="fc" id="L525">            valueHolder.name = Validate.notNull(name);</span>
<span class="fc" id="L526">            return this;</span>
        }

        /**
         * Value class to hold properties.
         */
<span class="fc" id="L532">        private static final class ValueHolder {</span>

            /**
             * Name of property.
             */
            String name;
            /**
             * Value of property.
             */
            Object value;
            /**
             * Next property.
             */
            ValueHolder next;
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>